<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="style.css" />
		<title>Transit Dashboard</title>
		<meta charset="UTF-8" />
	</head>
	<body>
		<h1>CTA Information</h1>
		<img src="https://upload.wikimedia.org/wikipedia/commons/a/ad/Chicago_Transit_Authority_Logo.svg" class="cta-logo"/>
		<h2>Trains</h2>
		<table id="train-table">
			<thead>
			  <tr>
				<th>Route</th>
				<th>Arrival Time</th>
			  </tr>
			</thead>
			<tbody id="train-list"></tbody>
		</table>
		<!-- <ul class="train-list" id="train-list"></ul> -->
	</body>
	<script>
		fetch('/api')
		  .then(response => response.json())
		  .then(data => {
			const dataContainer = document.getElementById('train-list');
			data.ctatt.eta.forEach(eta => {
				const row = document.createElement('tr');
				const routeCell = document.createElement('td');
				const arrTCell = document.createElement('td');

				const staName = eta.staNm;
				const destName = eta.destNm;
				const route = eta.rt;
				const arrT = eta.arrT;
				const currTime = new Date();
				const arrTime = new Date(arrT);
				const timeDiff = Math.ceil((arrTime - currTime) / (1000 * 60));
				const routeItem = document.createElement('li');
				// routeItem.textContent = `Station Name: ${staName}, Dest: ${destName}, Arriving in: ${timeDiff}`;
				row.classList.add(`route-${route}`);
				routeCell.textContent = staName;
				arrTCell.textContent = timeDiff;
				row.appendChild(routeCell);
				row.appendChild(arrTCell);
				dataContainer.appendChild(row);
				// dataContainer.appendChild(routeItem);

	
	
			});
		  })
		  .catch(error => {
			console.error('Error fetching API data:', error);
		  });

	  </script>
</html>